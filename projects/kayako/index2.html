<!DOCTYPE html>
<html lang="en">
<head>
	<title>Amaninder - Kayako Project</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	
	<link rel="icon" type="image/png" href="images/icons/favicon.ico"/>
	<link rel="stylesheet" type="text/css" href="vendor/bootstrap/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
	<link rel="stylesheet" type="text/css" href="vendor/animate/animate.css">
	<link rel="stylesheet" type="text/css" href="vendor/select2/select2.min.css">
	<link rel="stylesheet" type="text/css" href="css/util.css">
	<link rel="stylesheet" type="text/css" href="css/main.css">
	<link rel="stylesheet" href="css/style.css">

</head>
<body>

	<div class="flex-w flex-str size1 overlay1">
		<div class="flex-w flex-col-sb wsize1 bg0 p-l-70 p-t-37 p-b-52 p-r-50 respon1">
			<div class="wrappic1">
				<!-- <a href="/index.html">
					<img src="images/icons/logo.png" alt="IMG">
				</a> -->
				<a href="index.html"><img src="/logo/default.png" alt="logo" width="64px"></a>
			</div>		
	
			<div class="w-full p-t-100 p-b-90 p-l-48 p-l-0-md">
				
				<h3 class="l1-txt1 p-b-34 respon3">
					Kayako
				</h3>

				<p class="m2-txt1 p-b-46">
					Messenger Identification
				</p>

				<!-- <div id="start_chat"><button class="button button2" onclick="toggleMessenger(event)">Click here to start chat with Support</button></div><div id="kayako-unread-counts"></div> -->

				<form class="contact100-form validate-form m-t-10 m-b-10">
					<div class="wrap-input100 validate-input m-lr-auto-lg" data-validate = "Email is required: ex@abc.xyz">
						<input class="s2-txt1 placeholder0 input100 trans-04" type="text" name="email" placeholder="Username/ Email Address">

						<button class="flex-c-m ab-t-r size2 hov1 respon5" onclick="toggleMessenger(event)">
							<i class="zmdi zmdi-long-arrow-right fs-30 cl1 trans-04"></i>
						</button>

						<div class="flex-c-m ab-t-l s2-txt1 size4 bor1 respon4">
							<span>Chat Now</span>
						</div>
					</div>		
				</form>
				
			</div>
			
			<div class="flex-w flex-m">
				<span class="m2-txt2 p-r-40">
					Follow Me!
				</span>

				<a href="#" class="size3 flex-c-m how-social trans-04 m-r-15 m-b-5 m-t-5">
					<i class="fa fa-github"></i>
				</a>

				<a href="#" class="size3 flex-c-m how-social trans-04 m-r-15 m-b-5 m-t-5">
					<i class="fa fa-medium"></i>
				</a>

				<a href="#" class="size3 flex-c-m how-social trans-04 m-r-15 m-b-5 m-t-5">
					<i class="fa fa-twitter"></i>
				</a>
			</div>
		</div>
			

		<div class="wsize2 bg-img1 respon2" style="background-image: url('images/bg01.jpg');">
		</div>
	</div>
	
	<script src="vendor/jquery/jquery-3.2.1.min.js"></script>

	<script src="vendor/bootstrap/js/popper.js"></script>
	<script src="vendor/bootstrap/js/bootstrap.min.js"></script>

	<script src="vendor/select2/select2.min.js"></script>

	<script src="vendor/tilt/tilt.jquery.min.js"></script>

	<script src="js/main.js"></script>

	<script>(function(d,a){function c(){var b=d.createElement("script");b.async=!0;b.type="text/javascript";b.src=a._settings.messengerUrl;b.crossOrigin="anonymous";var c=d.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)}window.kayako=a;a.readyQueue=[];a.newEmbedCode=!0;a.ready=function(b){a.readyQueue.push(b)};a._settings={apiUrl:"https://acrossover.kayako.com/api/v1",messengerUrl:"https://acrossover.kayakocdn.com/messenger",realtimeUrl:"wss://kre.kayako.net/socket"};window.attachEvent?window.attachEvent("onload",c):window.addEventListener("load",c,!1)})(document,window.kayako||{});</script>
	  
	<script type="text/javascript">
		setTimeout(function () {
			kayako.ready(function () {
	
				// hide the launcher
				kayako.config = {
				  hideLauncher: true
				};
	
	
				// identity verification
				var timestamp = Math.floor(Date.now() / 1000);
				var name = 'User created via identify';
				var email = 'guruJedi@kayako.com';
				var token = 'nA72FrvchGZECYJkLK1edWveTC83kRdzi9KC5Mo9ccB3gfKbsbrcpfZhSmmHhgZ8';
				var signature = CryptoJS.HmacSHA256(name+email+token+timestamp, token).toString();
				kayako.identify(name, email, signature, timestamp);
	
	
				// function to display the unread messages
				kayako.on('unread_messages_count_changed', function (count) {
					const element = document.getElementById('kayako-unread-counts')
					if (count > 0) {
						var suffix = count === 1 ? '' : 's'
						element.style.display = 'inline-block'
						element.innerHTML = count + ' new message' + suffix
					} 
					else 
					{
						element.style.display = 'none'
					}
				});
	
	
				// function to check the conversation ID in local storage and post username from Exoclick
				kayako.on('chat_started', function (conversation) {
					
					function checkconversationID() {
						if (JSON.parse(window.localStorage.getItem('ko:conversation')).id) {
	
							var caseID = JSON.parse(window.localStorage.getItem('ko:conversation')).id;
							var fingerprint_id = window.localStorage.getItem('fingerprint_id');
							var usernameInExo = "aman"; //you can change this when implementing on Exoclick Portal
	
							var URL = "https://acrossover.kayako.com/api/v1/conversations/" + caseID + "/messages.json";
							
							var myHeaders = new Headers();
							myHeaders.append("X-FingerPrint-Id", fingerprint_id);
							myHeaders.append("Content-Type", "application/json;charset=UTF-8");
	
							var raw = "{\"contents\": \"username:" + usernameInExo + "\"}";
							
							var requestOptions = {
							  method: 'POST',
							  headers: myHeaders,
							  body: raw,
							  redirect: 'follow'
							};
	
							fetch(URL, requestOptions);
						}
						else {
							alert("No")
						}
					 }
					setTimeout(checkconversationID, 1000);
				});
			});
		});
	
	
		// toggle the messenger state
		function toggleMessenger (e) {
			  if (kayako.visibility() === 'minimized') {
				kayako.maximize()
			} 
			else {
				kayako.minimize()
			}
			e.preventDefault()
		}
	
	</script>


</body>
</html>